<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The IDA-LET-Machine: The IDA-LET-Machine (ILM)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The IDA-LET-Machine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">The IDA-LET-Machine (ILM) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The ILM is a simple implementation of the logical execution time (LET) paradigm for the automotive domain. In general it is based on a double buffering, to implement a zero-time communication between different cores. You can find the doxygen generated documentation <a href="https://matthiasb85.github.io/IDA-LET-Machine/index.html" title="ILM documentation">here</a></p>
<p>The ILM was developed as an operating system (OS) and hardware independent module. At the moment, we support the standard OSEK/AUTOSAR OS API, as the first OS port was based on ERIKA OS. The current hardware port is based on the CCU6 module of the AURIX TC2xx which is usually used for PWM generation.</p>
<p>The ILM is developed by the "Institut f√ºr Datentechnik und Kommunikationsnetze" (engl: Institute of Computer and Network Engineering, abbreviation <b>IDA</b>) of the TU Braunschweig. During 2016 and 2017 the development was mainly influenced by a collabortaion between IDA and Daimler RD/EIS.</p>
<h2>Where is the ILM intended for?</h2>
<p>Our mission is, to provide a simple and efficient test framework for the LET paradigm. This framework can be used in academia (e.g. for evaluation) or also for prototyping. In general the ILM can be used everywhere, where you would like to test something new, but don't want to have a huge ammount of 3rd party software in the background. <br />
 </p><h2>Where is the ILM not intended for?</h2>
<p>Although the license model does not exclude it explicitly, we would recommend not to use the ILM in any kind of series implementation. We have written the software to the best of our knowledge and belief, nevertheless it may still contain some bugs. Therefore we can not provide any kind of guarantee for functional correctness. For this kind of integegration there are several other commercial partners who provide their own implementation. As an example, Bosch and Continental do both provide an implementation of their interpretation of the LET paradigm.</p>
<h2>Folder Structure</h2>
<ul>
<li><b>ILM:</b> Core implementation of the ILM</li>
<li><b>Example:</b> Example with an generic application, using ERIKA OS on an Infineon AURIX TC275 (TriBoard TC275 or Hitex Shieldbuddy)</li>
<li><b>3rdParty:</b> Folder for external software (ERIKA OS, Infineon iLLD) including patches and build scripts</li>
</ul>
<h2>Where to start?</h2>
<p>In order to test the example, you need a build environment for the AURIX microcontroller. We use a Linux in combination with the HighTech tricore-gcc, but a cygwin installation (as used for ERIKA OS on a Windows) should also do the work.</p>
<div class="fragment"><div class="line">git clone https://github.com/matthiasb85/IDA-LET-Machine.git</div><div class="line">cd ./IDA-LET-Machine</div><div class="line">cd Example</div><div class="line">make</div></div><!-- fragment --><p> The Makefile checks if the 3rdParty software is available, if this is not the case the ./3rdParty/Setup3rdParty.sh script is executed. The script downloads the corresponding standalone version of ERIKA OS and RT-Druid, and applies some patches on it. The hardware port for the AURIX microcontroller uses Infineons iLLD library, which unfortunately is only available after registration. If the library is not available in ./3rdParty/Download when ./3rdParty/Setup3rdParty.sh is called, the script reports:</p>
<div class="fragment"><div class="line">Can&#39;t find Infineon iLLD!</div><div class="line">  1.) Please get in contact with Infineon</div><div class="line">  2.) Download the AURIX_iLLD_Package_TC2xx_v1.0.1.3.0 driver package</div><div class="line">  3.) Copy AURIX_iLLD_Package_TC2xx_v1.0.1.3.0.zip to ./3rdParty/Download</div><div class="line">  4.) Run &#39;make&#39;/&#39;make prepare&#39; in ./Example  or Setup3rdPartySoftware.sh in ./3rdParty</div></div><!-- fragment --><p> An important constraint is, that the entire library is available as source code. The reason for this is a bug inside the official CCU6 driver of the iLLD (which is patched during ./3rdParty/Setup3rdParty.sh).</p>
<h2>Supported Toolchains</h2>
<p>At the moment only the gcc based Tricore Toolchain from HighTec is supported by the application example. This limitation is based on the hardware port of the AURIX microcontroller. ILM core as well as the ERIKA OS port should work with many more gcc based compiler toolchains. Tested toolchains are:</p>
<ul>
<li><b>HighTec v4.9.1.0 on Windows with Cygwin64</b></li>
<li><b>HighTec v4.6.5.0 on Linux</b></li>
<li><b>HighTec v4.6.6.0 on Linux</b></li>
</ul>
<h2>Application example</h2>
<p>The application consist of 18 LET tasks. The layout of the example application can be found in ./Example/ilm_example.ods. The example uses a setup with three application cores. As the used AURIX microcontroller provides three cores, we use core C0 to generate the needed IRQ pattern. In addition, the application tasks are executed on all three cores. The worst-case execution time (WCET) of the corresponding block is assigned to an LET task on both application cores. If no function block is assigned to an LET task on C0, C1 or C2, the corresponding WCET is zero. In order to simulate an accurate timing behavior of the function blocks, we used an optimized <b>nop</b> loop consuming CPU time. Due to the different periods of the system, the hyperperiod is 100ms.</p>
<p>During execution of the simulated function blocks, we use pin toggles to indentify the current states. Those pin toggles are issued through the ILM hooks and at execution begin/end of a function block. The physical pin magging is located in ./Example/IO/gpio.c and the hook functions in ./Example/ILM/ilm_hooks.c</p>
<p>If you use a Lauterbach Trace32 based setup, you can use the ''make debug'' command inside ./Example to start a debug session. With ''t32_folder'', ''t32_arch'' and ''addr'' you can pass Trace32 base folder, host CPU architecure and IP address (DNS name) of your trace hardware to the system. If you omit the ''addr'' parameter, Trace32 uses the USB interface and searches for a locally connected device. As an example, the ''make debug'' call on my PC looks like this: </p><div class="fragment"><div class="line">make debug t32_folder=/home/matthiasb/opt/t32/files t32_arch=pc_linux addr=lauterbach1</div></div><!-- fragment --><p>The application uses a generic GPIO interface and toggles each output for a given event inside the user defined ILM hook functions in ./Example/ILM/cfg/ilm_hooks.c</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">GPIO ID  </th><th class="markdownTableHeadLeft">Event  </th><th class="markdownTableHeadLeft">Core   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">0  </td><td class="markdownTableBodyLeft">LET IRQ  </td><td class="markdownTableBodyLeft">C0   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">1  </td><td class="markdownTableBodyLeft">Start LET task (100ms)  </td><td class="markdownTableBodyLeft">C0   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">2  </td><td class="markdownTableBodyLeft">WCET function block (100ms)  </td><td class="markdownTableBodyLeft">C0   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">3  </td><td class="markdownTableBodyLeft">Start LET task (20ms)  </td><td class="markdownTableBodyLeft">C0   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">4  </td><td class="markdownTableBodyLeft">WCET function block (20ms)  </td><td class="markdownTableBodyLeft">C0   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">5  </td><td class="markdownTableBodyLeft">Start LET task (10ms)  </td><td class="markdownTableBodyLeft">C0   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">6  </td><td class="markdownTableBodyLeft">WCET function block (10ms)  </td><td class="markdownTableBodyLeft">C0   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">7  </td><td class="markdownTableBodyLeft">LET Event  </td><td class="markdownTableBodyLeft">C1   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">8  </td><td class="markdownTableBodyLeft">Start LET task (100ms)  </td><td class="markdownTableBodyLeft">C1   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">9  </td><td class="markdownTableBodyLeft">WCET function block (100ms)  </td><td class="markdownTableBodyLeft">C1   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">10  </td><td class="markdownTableBodyLeft">Start LET task (20ms)  </td><td class="markdownTableBodyLeft">C1   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">11  </td><td class="markdownTableBodyLeft">WCET function block (20ms)  </td><td class="markdownTableBodyLeft">C1   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">12  </td><td class="markdownTableBodyLeft">Start LET task (10ms)  </td><td class="markdownTableBodyLeft">C1   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">13  </td><td class="markdownTableBodyLeft">WCET function block (10ms)  </td><td class="markdownTableBodyLeft">C1   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">14  </td><td class="markdownTableBodyLeft">LET Event  </td><td class="markdownTableBodyLeft">C2   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">15  </td><td class="markdownTableBodyLeft">Start LET task (100ms)  </td><td class="markdownTableBodyLeft">C2   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">16  </td><td class="markdownTableBodyLeft">WCET function block (100ms)  </td><td class="markdownTableBodyLeft">C2   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">17  </td><td class="markdownTableBodyLeft">Start LET task (20ms)  </td><td class="markdownTableBodyLeft">C2   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">18  </td><td class="markdownTableBodyLeft">WCET function block (20ms)  </td><td class="markdownTableBodyLeft">C2   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">19  </td><td class="markdownTableBodyLeft">Start LET task (10ms)  </td><td class="markdownTableBodyLeft">C2   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">20  </td><td class="markdownTableBodyLeft">WCET function block (10ms)  </td><td class="markdownTableBodyLeft">C2   </td></tr>
</table>
<ul>
<li><b>LET IRQ/Event:</b> Set to 1 when processing an LET IRQ/Event. The AURIX HW port generates an CCU6 IRQ on C0 and redirectes the event to C1/2 via a general purpose service request (GPSRN).</li>
<li><b>Start LET task (y):</b> Set to 1 if an LET task with period <em>y</em> (100/20/10) is activated. Set to 0 at the end of an LET task. As the LET tasks are sequenced back-to-back, only a small peak is visible between LET task with the same period <em>y</em>.</li>
<li><b>WCET function block (y):</b> Set to 1 when the execution of the corresponding function block inside the corresponding OS task starts. Set to 0 when the block function finishes its execution. Again <em>y</em> denotes the corresponding period. Measuring the resulting pulse should lead to a value close to the defined worst-case execution time (WCET) defined in app_core_[0,1,2].c</li>
</ul>
<p>The example includes mappings for the Infineon TriBoard TC275 and the Hitex ShieldBuddy. The mapping of the generic GPIO IDs to the physical outputs is given in ./Example/IO/gpio.c and results in:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">GPIO ID  </th><th class="markdownTableHeadLeft">Triboard TC275  </th><th class="markdownTableHeadLeft">ShieldBuddy   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">0  </td><td class="markdownTableBodyLeft">P14.1  </td><td class="markdownTableBodyLeft">P14.7   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">1  </td><td class="markdownTableBodyLeft">P00.0  </td><td class="markdownTableBodyLeft">P14.8   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">2  </td><td class="markdownTableBodyLeft">P00.1  </td><td class="markdownTableBodyLeft">P14.9   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">3  </td><td class="markdownTableBodyLeft">P00.2  </td><td class="markdownTableBodyLeft">P14.10   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">4  </td><td class="markdownTableBodyLeft">P00.3  </td><td class="markdownTableBodyLeft">P15.6   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">5  </td><td class="markdownTableBodyLeft">P00.4  </td><td class="markdownTableBodyLeft">P15.7   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">6  </td><td class="markdownTableBodyLeft">P00.5  </td><td class="markdownTableBodyLeft">P20.1   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">7  </td><td class="markdownTableBodyLeft">P00.6  </td><td class="markdownTableBodyLeft">P10.1   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">8  </td><td class="markdownTableBodyLeft">P00.7  </td><td class="markdownTableBodyLeft">P10.0   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">9  </td><td class="markdownTableBodyLeft">P11.9  </td><td class="markdownTableBodyLeft">P33.6   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">10  </td><td class="markdownTableBodyLeft">P11.11  </td><td class="markdownTableBodyLeft">P33.0   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">11  </td><td class="markdownTableBodyLeft">P11.2  </td><td class="markdownTableBodyLeft">P33.4   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">12  </td><td class="markdownTableBodyLeft">P11.6  </td><td class="markdownTableBodyLeft">P00.6   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">13  </td><td class="markdownTableBodyLeft">P21.0  </td><td class="markdownTableBodyLeft">P00.7   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">14  </td><td class="markdownTableBodyLeft">P14.0  </td><td class="markdownTableBodyLeft">P00.8   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">15  </td><td class="markdownTableBodyLeft">P15.6  </td><td class="markdownTableBodyLeft">P33.12   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">16  </td><td class="markdownTableBodyLeft">P00.8  </td><td class="markdownTableBodyLeft">P33.11   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">17  </td><td class="markdownTableBodyLeft">P00.9  </td><td class="markdownTableBodyLeft">P02.8   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">18  </td><td class="markdownTableBodyLeft">P00.10  </td><td class="markdownTableBodyLeft">P02.7   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">19  </td><td class="markdownTableBodyLeft">P00.11  </td><td class="markdownTableBodyLeft">P02.6   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">20  </td><td class="markdownTableBodyLeft">P00.12  </td><td class="markdownTableBodyLeft">P33.1   </td></tr>
</table>
<p>Connecting the physical IOs to a logic analyzer/sniffer or oscilloscope should result in something like this: </p><div class="image">
<img src="https://matthiasb85.github.io/IDA-LET-Machine/LET_schedule.png" alt="LET Schedule" title="LET Schedule"/>
</div>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
